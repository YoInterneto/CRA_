% Author:
% Date: 28/03/2019

% Autor:  Daniel Lopez Moreno 03217279Q
%         Alvaro de las Heras Fernandez 03146833L
%         Samuel Garcia Gonzalez 09085497Z
% Fecha: 14/03/2019

%Consultas
:-consult('draw.pl').
:-consult('Diccionario.pl').

%Main
main(X,Y,Z):- comprobarDiccionario(Y),(oracion(X,Y,Z)->true;
                                                        write('Fallo De Concordancia'),false).

%Comprobar Diccionario
palabra(X):-adv(X).
palabra(X):-adj(X,_,_).
palabra(X):-con(X).
palabra(X):-prep(X).
palabra(X):-v(X,_,_).
palabra(X):-pron(X,_,_,_).
palabra(X):-n(X,_,_).
palabra(X):-nprop(X,_,_).
palabra(X):-det(X,_,_).
comprobarDiccionario([]).
comprobarDiccionario([X|Y]):-palabra(X)->comprobarDiccionario(Y);
                             write('Hay palabras que no estan presentes en el diccionario: '),write(X).

%Oracion
oracion(O)-->oracion_aux(O).

oracion_aux(o(GN,GV)) --> g_nominalP(GN,NUM1,PER1,GEN1), g_verbal(GV,NUM2,PER2,GEN2),{conc_Num(NUM1,NUM2)},{conc_Per(PER1,PER2)},{conc_Gen(GEN1,GEN2)},!.
oracion_aux(o(GV)) --> g_verbal(GV,_,_,_),!.
oracion_aux(OC) --> oracion_comp(OC).

%Oracion Compuesta
oracion_comp(ocomp(OS,O)) --> oracion_sub(OS),oracion_aux(O),!.
oracion_comp(ocomp(GV,OS)) -->  g_verbal(GV,_,_,_),oracion_sub(OS),!.
oracion_comp(ocomp(o(GN,GV),OS)) -->  g_nominalP(GN,_,_,_),g_verbal(GV,_,_,_),oracion_sub(OS),!.
oracion_comp(ocomp(OC)) --> oracion_coor(OC),!.

%Oracion Coordinada
oracion_coor(ocoor(GV,C,O2)) --> g_verbal(GV,_,_,_),conjuncion(C),oracion_aux(O2).
oracion_coor(ocoor(GN,GV,C,O2)) --> g_nominalP(GN,_,_,_),g_verbal(GV,_,_,_),conjuncion(C),oracion_aux(O2).

%Oracion Subordinada de relativo
oracion_sub(osub(GN,P,GV)) --> g_nominalP(GN,_,_,_),preposicion(P),g_verbal(GV,_,_,_).
oracion_sub(osub(P,O)) --> preposicion(P),oracion_aux(O).
oracion_sub(osub(A,GN,GV)) --> adverbio(A),g_nominalP(GN,NUM1,PER1,_),g_verbal(GV,NUM2,PER2,_),{conc_Num(NUM1,NUM2)},{conc_Per(PER1,PER2)}.

%Grupo Nominal
g_nominalP(gncomp(GN,C,GN2,A),'plural','tercera',GEN1) --> g_nominal(GN,_,_,GEN1),conjuncion(C),g_nominal(GN2,_,_,_),adjetivo(A,_,NUM3),{conc_Num('plural',NUM3)}.
g_nominalP(gncomp(GN,C,GN2),'plural','tercera',GEN1) --> g_nominal(GN,_,_,GEN1),conjuncion(C),g_nominal(GN2,_,_,_).
g_nominalP(GN,NUM,PER,GEN) --> g_nominal(GN,NUM,PER,GEN).


g_nominal(gn(N,A),NUM2,'tercera',GEN1) --> nombre(N,GEN1,NUM1), g_adjetival(A,GEN2,NUM2),{conc_Gen(GEN1,GEN2)},{conc_Num(NUM1,NUM2)}.
g_nominal(gn(N,N2),NUM2,'tercera',GEN2) --> nombre(N,_,_),nombre(N2,GEN2,NUM2).
g_nominal(gn(D,N,GP),NUM2,'tercera',GEN2) --> determinante(D,GEN1,NUM1), nombre(N,GEN2,NUM2),g_preposicional(GP),{conc_Gen(GEN1,GEN2)},{conc_Num(NUM1,NUM2)}.
g_nominal(gn(N,GP),NUM,'tercera',GEN) --> nombre(N,GEN,NUM),g_preposicional(GP).
g_nominal(gn(N),NUM,'tercera',GEN) --> nombre(N,GEN,NUM).
g_nominal(gn(N),NUM,'tercera',GEN) --> nombre_prop(N,GEN,NUM).
g_nominal(gn(N),NUM,PER,GEN) --> pronombre(N,GEN,NUM,PER).
g_nominal(gn(D,N,A),NUM2,'tercera',_) --> determinante(D,GEN1,NUM1),nombre(N,GEN2,NUM2), g_adjetival(A,GEN3,NUM3),{conc_Gen(GEN1,GEN2)},{conc_Gen(GEN2,GEN3)},{conc_Num(NUM1,NUM2)},{conc_Num(NUM2,NUM3)}.
g_nominal(gn(D,N,A,GP),NUM2,'tercera',GEN2) --> determinante(D,GEN1,NUM1),nombre(N,GEN2,NUM2), adjetivo(A,GEN3,NUM3),g_preposicional(GP),{conc_Gen(GEN1,GEN2)},{conc_Gen(GEN2,GEN3)},{conc_Num(NUM1,NUM2)},{conc_Num(NUM2,NUM3)}.
g_nominal(gn(A,N),NUM2,'tercera',GEN2) --> adjetivo(A,GEN1,NUM1),nombre(N,GEN2,NUM2),{conc_Gen(GEN1,GEN2)},{conc_Num(NUM1,NUM2)}.
g_nominal(gn(D,A,N),NUM3,'tercera',GEN3) --> determinante(D,GEN1,NUM1),adjetivo(A,GEN2,NUM2),nombre(N,GEN3,NUM3),{conc_Gen(GEN1,GEN2)},{conc_Gen(GEN2,GEN3)},{conc_Num(NUM1,NUM2)},{conc_Num(NUM2,NUM3)}.
g_nominal(gn(D,N),NUM2,'tercera',GEN2) --> determinante(D,GEN1,NUM1), nombre(N,GEN2,NUM2),{conc_Gen(GEN1,GEN2)},{conc_Num(NUM1,NUM2)}.

%Grupo Adjetival
g_adjetival(gadj(ADV,A),GEN,NUM)-->adverbio(ADV),adjetivo(A,GEN,NUM).
g_adjetival(gadj(A,GP),GEN,NUM)--> adjetivo(A,GEN,NUM),g_preposicional(GP).
g_adjetival(gadj(A),GEN,NUM)--> adjetivo(A,GEN,NUM).

%Grupo Adverbial

g_adverbial(gadv(AD,GN)) -->adverbio(AD),g_nominalP(GN,_,_,_).
g_adverbial(gadv(AD,GP)) -->adverbio(AD),g_preposicional(GP).
g_adverbial(gadv(AD,AD2,GP)) -->adverbio(AD),adverbio(AD2),g_preposicional(GP).
g_adverbial(gadv(AD,AD2)) -->adverbio(AD),adverbio(AD2).
g_adverbial(gadv(AD)) -->adverbio(AD).

%Grupo Proposicional
g_preposicional(gprep(P,GN)) --> preposicion(P),g_nominalP(GN,_,_,_).

%Grupo Verbal
g_verbal(gv(V,GP),NUM,PER,'neutro') --> verbo(V,NUM,PER),g_preposicional(GP).
g_verbal(gv(V,GN),NUM1,PER1,'neutro') --> verbo(V,NUM1,PER1),g_nominalP(GN,_,_,_),!.
g_verbal(gv(V,A),NUM1,PER1,GEN2) --> verbo(V,NUM1,PER1),g_adjetival(A,GEN2,NUM2),{conc_Num(NUM1,NUM2)}.
g_verbal(gv(V),NUM,PER,'neutro') --> verbo(V,NUM,PER).
g_verbal(gv(V,A),NUM,PER,'neutro') --> verbo(V,NUM,PER),g_adverbial(A).



%CONCORDANCIAS
conc_Gen(GEN1,GEN2):- GEN1='neutro';GEN2='neutro';GEN1=GEN2.
conc_Num(NUM1,NUM2):- NUM1='neutro';NUM2='neutro';NUM1=NUM2.
conc_Per(PER1,PER2):- PER1='neutro';PER2='neutro';PER1=PER2.



%1  oracion(X,[el,hombre,come,una,manzana],[]), draw(X).
%2  oracion(X,[la,mujer,come,manzanas],[]), draw(X).
%3  oracion(X,['maría',come,una,manzana,roja],[]), draw(X).
%4  oracion(X,[juan,ama,a,'maría'],[]), draw(X).
%5  oracion(X,[el,gato,grande,come,un,'ratón',gris],[]), draw(X).
%6  oracion(X,[juan,estudia,en,la,universidad],[]), draw(X).
%7  oracion(X,[el,alumno,ama,la,universidad],[]), draw(X).
%8  oracion(X,[el,gato,come,ratones],[]), draw(X).
%9  oracion(X,[el,'ratón',que,'cazó',el,gato,era,gris],[]), draw(X).
%10 oracion(X,[la,universidad,es,grande],[]), draw(X).

%1   oracion(X,[el,hombre,grande,come,la,manzana,roja],[]), draw(X).  FUNCIONA CONCORDANCIA
%2   oracion(X,[el,hombre,con,un,tenedor,grande,come,la,manzana,roja],[]), draw(X).   FUNCIONA CONCORDANCIA
%3   oracion(X,[juan,y,'maría',comen,la,manzana,roja,con,un,tenedor,y,un,cuchillo],[]), draw(X).   FUNCIONA CONCORDANCIA
%4   oracion(X,[ella,hace,la,'práctica',de,juan],[]), draw(X).    FUNCIONA CONCORDANCIA
%5   oracion(X,[el,canario,de,juan,y,'maría',canta],[]), draw(X).   FUNCIONA CONCORDANCIA
%6   oracion(X,[la,blanca,paloma,'alzó',el,vuelo],[]), draw(X).  FUNCIONA CONCORDANCIA
%7   oracion(X,['está',muy,lejos,de,madrid],[]), draw(X).      FUNCIONA CONCORDANCIA
%8   oracion(X,['él',es,lento,de,reflejos],[]), draw(X).//////////////////////////////////////////////COMPROBAR CONCORDANCIA ENTRE EL Y LENTO
%9   oracion(X,[juan,habla,muy,claramente],[]), draw(X).    FUNCIONA CONCORDANCIA
%10  oracion(X,[la,esperanza,de,vida,de,un,'niño',depende,de,su,lugar,de,nacimiento],[]), draw(X).  FUNCIONA CONCORDANCIA (PERO MIRAR LA CONCORDANCIA EJEMPLO:"LUGAR DE NACIMIENTOS")
%11  oracion(X,[el,hombre,que,vimos,en,la,universidad,era,mi,profesor],[]), draw(X).   FUNCIONA (PERO MIRAR CONCORDANCIA ENTRE EL HOMBRE Y ERA)
%12  oracion(X,[juan,que,es,muy,delicado,come,solamente,manzanas,rojas],[]), draw(X).   FUNCIONA (MIRAR CONCORDANCIA JUAN QUE ES MUY BLANCA)
%13  oracion(X,[el,procesador,de,textos,que,es,una,herramienta,muy,potente,sirve,para,escribir,documentos],[]), draw(X).  FUNCIONA PERO PETA CUANDO PONES LA PROCESADOR
%14  oracion(X,[juan,es,moreno,y,'maría',es,alta],[]), draw(X).  FUNCIONA, PERO METER CONCORDANCIA ENTRE SUJETO Y ADJETIVO DE PREDICADO
%15  oracion(X,[juan,recoge,la,mesa,mientras,'maría',toma,'café'],[]), draw(X).  FUNCIONA CONCORDANCIA EN LA PARTE DE MARIA, PERO NO EN JUAN
%16  oracion(X,['compré',un,'pantalón',y,una,corbata,negros],[]), draw(X).       FUNCIONA CONCORDANCIA
%17  oracion(X,[juan,y,hector,comen,patatas,fritas,y,beben,cerveza],[]), draw(X). FUNCIONA, PERO PETA CON RECURSIVIDAD POR IZQUIERDA
%18  oracion(X,[irene,canta,y,salta,mientras,juan,estudia],[]), draw(X).          FUNCIONA LA PARTE DE JUAN PERO NO IRENE
%19  oracion(X,[irene,canta,y,salta,y,sonrie,alegre],[]), draw(X). //Niveles no quedan bonitos METER CONCORDANCIA
%20  oracion(X,[el,procesador,de,textos,es,una,herramienta,muy,potente,que,sirve,para,escribir,documentos,pero,es,bastante,lento],[]), draw(X). MIRAR CONCORDANCIA



